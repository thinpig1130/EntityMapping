# [ 실전매핑 No.1 ] 1:N , N:1 매핑

## 매핑에 사용되는 어노테이션
 1:N, N:1 매핑에 사용되는 어노테이션은 @JoinColumn, @ManyToOne, @OneToMany 이다. 

### @JoinColumn
외래키를 매핑할 때 사용하는 속성이다.
일반적으로 외래키가 위치한 테이블과 매핑된 엔티티 매핑컬럼에 붙는다.

| 속성                   | 기능                     | 기본값                      | 비고  |
|:---------------------|:-----------------------|:-------------------------|:----|
| name                 | 매핑할 외래키 이름             | 필드명 +_+ 참조하는 테이블의 기본 키 컬럼명 | |
| referencedColumnName | 외래 키가 참조하는 대상 테이블의 컬럼명 | | |
| unique               | @Column 속성과 동일         |                          | DDL |
| nullable             | @Column 속성과 동일         |                          | DDL |
| insertable           | @Column 속성과 동일         |                          |     |
| updatable            | @Column 속성과 동일         |                          |     |
| columnDefinition     | @Column 속성과 동일         |                          | DDL |
| table                | @Column 속성과 동일         |                          |     |
| foreignKey           | 외래키 제약조건을 직접 지정할 수 있다. |                          | DDL |

### @ManyToOne
N:1 관계에서 N쪽 객체에서 1쪽 객체를 참조하는 필드에 붙이는 어노테이션이다.
테이블에서는 외래키가 위치한 쪽이 N이기 때문에 @JoinColumn과 같이 쓰이는 경우가 많다.

| 속성                   | 기능                                                                 | 기본값                                                   | 비고  |
|:---------------------|:-------------------------------------------------------------------|:------------------------------------------------------|:----|
| targetEntity | 연관된 엔티티의 타입 정보를 설정한다. 컬렉션을 사용해도 제네릭으로 타입정보를 알수 있기 때문에 거의 사용하지 않는다. |                                                       |     |
| cascade | 영속성 전이 기능을 사용한다.                                                   |                                                       |     |
| fetch | 글로벌 페치 전략을 사용한다.                                                   | @ManyToOne=FetchType.EAGER, @OneToMany=FetchType.LAZY | |
| optional | false로 설정하면 연관된 엔티티가 항상 있어야 한다.                                    | true                                                  |

### @OneToMany
1:N 관계에서 1쪽 객체에서 N쪽 객체를 참조하는 필드에 붙이는 어노테이션이다.

| 속성           | 기능                                               | 기본값   | 비고                     |
|:-------------|:-------------------------------------------------|:------|:-----------------------|
| targetEntity | @ManyToOne 속성과 동일                                |       |                        |
| cascade      | @ManyToOne 속성과 동일                                |       |                        |
| fetch        | @ManyToOne 속성과 동일                                |       |                        |
| mappedBy     | 양방향 매핑일 때 사용하는 속성으로, Owner가 아닌 객체에서 사용되는 속성이다.   |       | 반대쪽 매핑의 필드 이름을 값으로 사용  |
| orphanRemoval | 참조가 제거된 엔티티는 다른 곳에서 참조하지 않는 고아 객체로 보고 삭제하는 기능 설정 | false |                        |


## 매핑 실전
### 1:N, N:1 양방향 매핑 - twoway
연관관계 편의 메소드
